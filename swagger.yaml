openapi: 3.0.7
info:
  title: Metamind API
  description: Brain spec for Metamind.
  version: 2.0.0
security:
  - basicAuth:
      []
paths:
  /stories:
    get:
      operationId: listStories
      summary: List stories
      description: List stories
      tags:
        - Stories
      responses:
        "200":
          description: Stories
          content:
            application/json;charset=utf-8:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/Story"
        "400":
          description: Invalid request was sent to the server
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/BadRequest"
        "403":
          description: Attempted to make a call with unauthorized client
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/Forbidden"
        "500":
          description: Internal server error
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/InternalServerError"
    post:
      operationId: createStory
      summary: Create a story
      description: Create story
      tags:
        - Stories
      requestBody:
        content:
          application/json;charset=utf-8:
            schema:
              $ref: "#/components/schemas/Story"
        description: Payload
        required: true
      responses:
        "200":
          description: Created story
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/Story"
        "400":
          description: Invalid request was sent to the server
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/BadRequest"
        "403":
          description: Attempted to make a call with unauthorized client
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/Forbidden"
        "500":
          description: Internal server error
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/InternalServerError"
  /stories/{storyId}:
    get:
      operationId: findStory
      summary: Finds a story
      description: Finds a story
      tags:
        - Stories
      parameters:
        - name: storyId
          required: true
          in: path
          description: story id
          schema:
            type: string
            format: uuid
      responses:
        "200":
          description: Found story
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/Story"
        "400":
          description: Invalid request was sent to the server
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/BadRequest"
        "403":
          description: Attempted to make a call with unauthorized client
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/Forbidden"
        "500":
          description: Internal server error
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/InternalServerError"
    put:
      operationId: updateStory
      summary: Updates story
      description: Updates a story
      tags:
        - Stories
      parameters:
        - name: storyId
          required: true
          in: path
          description: story id
          schema:
            type: string
            format: uuid
      requestBody:
        content:
          application/json;charset=utf-8:
            schema:
              $ref: "#/components/schemas/Story"
        description: Payload
        required: true
      responses:
        "200":
          description: Updated story
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/Story"
        "400":
          description: Invalid request was sent to the server
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/BadRequest"
        "403":
          description: Attempted to make a call with unauthorized client
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/Forbidden"
        "500":
          description: Internal server error
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/InternalServerError"
    delete:
      operationId: deleteStory
      summary: Delete story
      description: Delete a story
      tags:
        - Stories
      parameters:
        - name: storyId
          required: true
          in: path
          description: story id
          schema:
            type: string
            format: uuid
      responses:
        "204":
          description: Successful removal
        "400":
          description: Invalid request was sent to the server
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/BadRequest"
        "403":
          description: Attempted to make a call with unauthorized client
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/Forbidden"
        "500":
          description: Internal server error
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/InternalServerError"
                
  /stories/{storyId}/knots:
    get:
      operationId: listKnots
      summary: List story knots
      description: List story knots
      parameters:
        - name: storyId
          required: true
          in: path
          description: story id
          schema:
            type: string
            format: uuid
      tags:
        - Knots
      responses:
        "200":
          description: Story knots
          content:
            application/json;charset=utf-8:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/Knot"
        "400":
          description: Invalid request was sent to the server
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/BadRequest"
        "403":
          description: Attempted to make a call with unauthorized client
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/Forbidden"
        "500":
          description: Internal server error
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/InternalServerError"
    post:
      operationId: createKnot
      summary: Create a story knot
      description: Create story knot
      tags:
        - Knots
      parameters:
        - name: storyId
          required: true
          in: path
          description: story id
          schema:
            type: string
            format: uuid
      requestBody:
        content:
          application/json;charset=utf-8:
            schema:
              $ref: "#/components/schemas/Knot"
        description: Payload
        required: true
      responses:
        "200":
          description: Created story knot
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/Knot"
        "400":
          description: Invalid request was sent to the server
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/BadRequest"
        "403":
          description: Attempted to make a call with unauthorized client
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/Forbidden"
        "500":
          description: Internal server error
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/InternalServerError"
  /stories/{storyId}/knots/{knotId}:
    get:
      operationId: findKnot
      summary: Finds a story knot
      description: Finds a story knot
      tags:
        - Knots
      parameters:
        - name: storyId
          required: true
          in: path
          description: story id
          schema:
            type: string
            format: uuid
        - name: knotId
          required: true
          in: path
          description: knot id
          schema:
            type: string
            format: uuid
      responses:
        "200":
          description: Found story knot
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/Knot"
        "400":
          description: Invalid request was sent to the server
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/BadRequest"
        "403":
          description: Attempted to make a call with unauthorized client
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/Forbidden"
        "500":
          description: Internal server error
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/InternalServerError"
    put:
      operationId: updateKnot
      summary: Updates knot
      description: Updates a knot
      tags:
        - Knots
      parameters:
        - name: storyId
          required: true
          in: path
          description: story id
          schema:
            type: string
            format: uuid
        - name: knotId
          required: true
          in: path
          description: knot id
          schema:
            type: string
            format: uuid
      requestBody:
        content:
          application/json;charset=utf-8:
            schema:
              $ref: "#/components/schemas/Knot"
        description: Payload
        required: true
      responses:
        "200":
          description: Updated story knot
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/Story"
        "400":
          description: Invalid request was sent to the server
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/BadRequest"
        "403":
          description: Attempted to make a call with unauthorized client
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/Forbidden"
        "500":
          description: Internal server error
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/InternalServerError"
    delete:
      operationId: deleteKnot
      summary: Delete knot
      description: Delete a knot
      tags:
        - Knots
      parameters:
        - name: storyId
          required: true
          in: path
          description: story id
          schema:
            type: string
            format: uuid
        - name: knotId
          required: true
          in: path
          description: knot id
          schema:
            type: string
            format: uuid
      responses:
        "204":
          description: Successful removal
        "400":
          description: Invalid request was sent to the server
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/BadRequest"
        "403":
          description: Attempted to make a call with unauthorized client
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/Forbidden"
        "500":
          description: Internal server error
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/InternalServerError"

  /stories/{storyId}/intents:
    get:
      operationId: listIntents
      summary: List story intents
      description: List story intents
      parameters:
        - name: storyId
          required: true
          in: path
          description: story id
          schema:
            type: string
            format: uuid
      tags:
        - Intents
      responses:
        "200":
          description: Story intents
          content:
            application/json;charset=utf-8:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/Intent"
        "400":
          description: Invalid request was sent to the server
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/BadRequest"
        "403":
          description: Attempted to make a call with unauthorized client
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/Forbidden"
        "500":
          description: Internal server error
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/InternalServerError"
    post:
      operationId: createIntent
      summary: Create a story intent
      description: Create story intent
      tags:
        - Intents
      parameters:
        - name: storyId
          required: true
          in: path
          description: story id
          schema:
            type: string
            format: uuid
      requestBody:
        content:
          application/json;charset=utf-8:
            schema:
              $ref: "#/components/schemas/Intent"
        description: Payload
        required: true
      responses:
        "200":
          description: Created story intent
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/Intent"
        "400":
          description: Invalid request was sent to the server
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/BadRequest"
        "403":
          description: Attempted to make a call with unauthorized client
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/Forbidden"
        "500":
          description: Internal server error
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/InternalServerError"
  /stories/{storyId}/intents/{intentId}:
    get:
      operationId: findIntent
      summary: Finds a story intent
      description: Finds a story intent
      tags:
        - Intents
      parameters:
        - name: storyId
          required: true
          in: path
          description: story id
          schema:
            type: string
            format: uuid
        - name: intentId
          required: true
          in: path
          description: intent id
          schema:
            type: string
            format: uuid
      responses:
        "200":
          description: Found story intent
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/Intent"
        "400":
          description: Invalid request was sent to the server
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/BadRequest"
        "403":
          description: Attempted to make a call with unauthorized client
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/Forbidden"
        "500":
          description: Internal server error
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/InternalServerError"
    put:
      operationId: updateIntent
      summary: Updates intent
      description: Updates a intent
      tags:
        - Intents
      parameters:
        - name: storyId
          required: true
          in: path
          description: story id
          schema:
            type: string
            format: uuid
        - name: intentId
          required: true
          in: path
          description: intent id
          schema:
            type: string
            format: uuid
      requestBody:
        content:
          application/json;charset=utf-8:
            schema:
              $ref: "#/components/schemas/Intent"
        description: Payload
        required: true
      responses:
        "200":
          description: Updated story intent
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/Story"
        "400":
          description: Invalid request was sent to the server
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/BadRequest"
        "403":
          description: Attempted to make a call with unauthorized client
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/Forbidden"
        "500":
          description: Internal server error
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/InternalServerError"
    delete:
      operationId: deleteIntent
      summary: Delete intent
      description: Delete a intent
      tags:
        - Intents
      parameters:
        - name: storyId
          required: true
          in: path
          description: story id
          schema:
            type: string
            format: uuid
        - name: intentId
          required: true
          in: path
          description: intent id
          schema:
            type: string
            format: uuid
      responses:
        "204":
          description: Successful removal
        "400":
          description: Invalid request was sent to the server
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/BadRequest"
        "403":
          description: Attempted to make a call with unauthorized client
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/Forbidden"
        "500":
          description: Internal server error
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/InternalServerError"

  /stories/{storyId}/sessions:
    post:
      operationId: createSession
      summary: Creates new session
      description: Creates new chat session
      requestBody:
        content:
          application/json;charset=utf-8:
            schema:
              $ref: "#/components/schemas/Session"
        description: Payload
        required: true
      tags:
        - Sessions
      parameters:
        - name: storyId
          required: true
          in: path
          description: story id
          schema:
            type: string
            format: uuid
      responses:
        "200":
          description: Created session
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/Session"
        "400":
          description: Invalid request was sent to the server
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/BadRequest"
        "403":
          description: Attempted to make a call with unauthorized client
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/Forbidden"
        "500":
          description: Internal server error
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/InternalServerError"
                
                
  /stories/{storyId}/messages:
    post:
      operationId: createMessage
      summary: Posts new message
      description: Posts new message
      requestBody:
        content:
          application/json;charset=utf-8:
            schema:
              $ref: "#/components/schemas/Message"
        description: Payload
        required: true
      parameters:
        - name: storyId
          required: true
          in: path
          description: story id
          schema:
            type: string
            format: uuid
      tags:
        - Messages
      responses:
        "200":
          description: Returns message with bot's response details
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/Message"
        "400":
          description: Invalid request was sent to the server
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/BadRequest"
        "403":
          description: Attempted to make a call with unauthorized client
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/Forbidden"
        "500":
          description: Internal server error
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/InternalServerError"

  /scripts:
    get:
      operationId: listScripts
      summary: List scripts
      description: List scripts
      tags:
        - Scripts
      responses:
        "200":
          description: Scripts
          content:
            application/json;charset=utf-8:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/Script"
        "400":
          description: Invalid request was sent to the server
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/BadRequest"
        "403":
          description: Attempted to make a call with unauthorized client
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/Forbidden"
        "500":
          description: Internal server error
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/InternalServerError"
    post:
      operationId: createScript
      summary: Create a script
      description: Create script
      tags:
        - Scripts
      requestBody:
        content:
          application/json;charset=utf-8:
            schema:
              $ref: "#/components/schemas/Script"
        description: Payload
        required: true
      responses:
        "200":
          description: Created script
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/Script"
        "400":
          description: Invalid request was sent to the server
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/BadRequest"
        "403":
          description: Attempted to make a call with unauthorized client
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/Forbidden"
        "500":
          description: Internal server error
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/InternalServerError"
  /scripts/{scriptId}:
    get:
      operationId: findScript
      summary: Finds a script
      description: Finds a script
      tags:
        - Scripts
      parameters:
        - name: scriptId
          required: true
          in: path
          description: script id
          schema:
            type: string
            format: uuid
      responses:
        "200":
          description: Found script
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/Script"
        "400":
          description: Invalid request was sent to the server
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/BadRequest"
        "403":
          description: Attempted to make a call with unauthorized client
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/Forbidden"
        "500":
          description: Internal server error
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/InternalServerError"
    put:
      operationId: updateScript
      summary: Updates script
      description: Updates a script
      tags:
        - Scripts
      parameters:
        - name: scriptId
          required: true
          in: path
          description: script id
          schema:
            type: string
            format: uuid
      requestBody:
        content:
          application/json;charset=utf-8:
            schema:
              $ref: "#/components/schemas/Script"
        description: Payload
        required: true
      responses:
        "200":
          description: Updated script
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/Script"
        "400":
          description: Invalid request was sent to the server
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/BadRequest"
        "403":
          description: Attempted to make a call with unauthorized client
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/Forbidden"
        "500":
          description: Internal server error
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/InternalServerError"
    delete:
      operationId: deleteScript
      summary: Delete script
      description: Delete a script
      tags:
        - Scripts
      parameters:
        - name: scriptId
          required: true
          in: path
          description: script id
          schema:
            type: string
            format: uuid
      responses:
        "204":
          description: Successful removal
        "400":
          description: Invalid request was sent to the server
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/BadRequest"
        "403":
          description: Attempted to make a call with unauthorized client
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/Forbidden"
        "500":
          description: Internal server error
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/InternalServerError"
  
  /stories/{storyId}/variables:
    get:
      operationId: listVariables
      summary: List story variables
      description: List story variables
      parameters:
        - name: storyId
          required: true
          in: path
          description: story id
          schema:
            type: string
            format: uuid
      tags:
        - Variables
      responses:
        "200":
          description: Story variables
          content:
            application/json;charset=utf-8:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/Variable"
        "400":
          description: Invalid request was sent to the server
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/BadRequest"
        "403":
          description: Attempted to make a call with unauthorized client
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/Forbidden"
        "500":
          description: Internal server error
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/InternalServerError"
    post:
      operationId: createVariable
      summary: Create a story variable
      description: Create story variable
      tags:
        - Variables
      parameters:
        - name: storyId
          required: true
          in: path
          description: story id
          schema:
            type: string
            format: uuid
      requestBody:
        content:
          application/json;charset=utf-8:
            schema:
              $ref: "#/components/schemas/Variable"
        description: Payload
        required: true
      responses:
        "200":
          description: Created story variable
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/Variable"
        "400":
          description: Invalid request was sent to the server
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/BadRequest"
        "403":
          description: Attempted to make a call with unauthorized client
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/Forbidden"
        "500":
          description: Internal server error
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/InternalServerError"
  /stories/{storyId}/variables/{variableId}:
    get:
      operationId: findVariable
      summary: Finds a story variable
      description: Finds a story variable
      tags:
        - Variables
      parameters:
        - name: storyId
          required: true
          in: path
          description: story id
          schema:
            type: string
            format: uuid
        - name: variableId
          required: true
          in: path
          description: variable id
          schema:
            type: string
            format: uuid
      responses:
        "200":
          description: Found story variable
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/Variable"
        "400":
          description: Invalid request was sent to the server
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/BadRequest"
        "403":
          description: Attempted to make a call with unauthorized client
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/Forbidden"
        "500":
          description: Internal server error
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/InternalServerError"
    put:
      operationId: updateVariable
      summary: Updates variable
      description: Updates a variable
      tags:
        - Variables
      parameters:
        - name: storyId
          required: true
          in: path
          description: story id
          schema:
            type: string
            format: uuid
        - name: variableId
          required: true
          in: path
          description: variable id
          schema:
            type: string
            format: uuid
      requestBody:
        content:
          application/json;charset=utf-8:
            schema:
              $ref: "#/components/schemas/Variable"
        description: Payload
        required: true
      responses:
        "200":
          description: Updated story variable
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/Story"
        "400":
          description: Invalid request was sent to the server
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/BadRequest"
        "403":
          description: Attempted to make a call with unauthorized client
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/Forbidden"
        "500":
          description: Internal server error
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/InternalServerError"
    delete:
      operationId: deleteVariable
      summary: Delete variable
      description: Delete a variable
      tags:
        - Variables
      parameters:
        - name: storyId
          required: true
          in: path
          description: story id
          schema:
            type: string
            format: uuid
        - name: variableId
          required: true
          in: path
          description: variable id
          schema:
            type: string
            format: uuid
      responses:
        "204":
          description: Successful removal
        "400":
          description: Invalid request was sent to the server
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/BadRequest"
        "403":
          description: Attempted to make a call with unauthorized client
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/Forbidden"
        "500":
          description: Internal server error
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/InternalServerError"

servers:
  - url: /v2
components:
  securitySchemes:
    basicAuth:
      type: http
      scheme: basic
  schemas:
    Story:
      type: object
      properties:
        id:
          description: Story id.
          type: string
          format: uuid
        name:
          description: Story name.
          type: string
        created:
          description: Creation time
          type: string
          format: date-time
        modified:
          description: Modification time
          type: string
          format: date-time
  
    Session:
      type: object
      properties:
        id:
          description: Session id.
          type: string
          format: uuid
        locale:
          description: Session locale
          type: string
        timeZone:
          description: Session time zone
          type: string
        visitor:
          description: Visitor details
          type: string
        storyId:
          description: Story id
          type: string
          format: uuid
        created:
          description: Time the session was initiated
          type: string
          format: date-time
          
    Knot:
      type: object
      properties:
        id:
          description: knot id.
          type: string
          format: uuid
        type: 
          $ref: "#/components/schemas/KnotType"
        name:
          type: string
        content:
          type: string
        storyId:
          description: Story id
          type: string
          format: uuid
        
    KnotType:
      type: string
      enum:
        - TEXT
        - SCRIPT
        - IMAGE
        - EMAIL
          
    Intent:
      type: object
      properties:
        id:
          description: intent id.
          type: string
          format: uuid
        type: 
          $ref: "#/components/schemas/IntentType"
        sourceKnotId:
          description: source knot id id.
          type: string
          format: uuid
        targetKnotId:
          description: target knot id id.
          type: string
          format: uuid
        global:
          type: boolean
        
    IntentType:
      type: string
      enum:
        - OPENNLP
        - TEMPLATE

    Message:
      type: object
      properties:
        id:
          description: Message id
          type: string
          format: uuid
        sessionId:
          description: Session id the message belongs to
          type: string
          format: uuid
        content:
          description: Message content
          type: string
        response:
          description: Response text. Used only when responding
          type: 
            array
          items:
            type: string
        hint:
          description: Hint text. Used only when responding
          type: string
        quickResponses:
          description: List of quick responses. Used only when responding
          type: array
          items:
            type: string
        confidence:
          description: Value how confident the bot was about the intent
          type: number
          format: double
        sourceKnotId:
          description: source knot id id.
          type: string
          format: uuid
        matchedIntentId:
          description: matched intent id. Null if intent not found
          type: string
          format: uuid
        created:
          description: Time the session was initiated
          type: string
          format: date-time
          
    Variable:
      type: object
      properties:
        id:
          description: variable id.
          type: string
          format: uuid
        type: 
          $ref: "#/components/schemas/VariableType"
        storyId:
          description: Story id
          type: string
          format: uuid
        validationScript:
          type: string
          description: Validation script

    VariableType:
      type: string
      enum:
        - STRING
        - NUMBER
          
    Script:
      type: object
      required:
        - name
        - version
        - language
        - content
      properties:
        id:
          description: Script id
          type: string
          format: uuid
        name:
          description: Script name
          type: string
        version:
          description: Script version
          type: string
        language:
          description: Script language
          type: string
        content:
          description: Script content
          type: string
          
    InternalServerError:
      type: object
      properties:
        code:
          type: integer
          format: int32
        message:
          type: string
          
    Forbidden:
      type: object
      properties:
        code:
          type: integer
          format: int32
        message:
          type: string
          
    BadRequest:
      type: object
      properties:
        code:
          type: integer
          format: int32
        message:
          type: string
          
    NotImplemented:
      type: object
      properties:
        code:
          type: integer
          format: int32
        message:
          type: string
          
    NotFound:
      type: object
      properties:
        code:
          type: integer
          format: int32
        message:
          type: string
