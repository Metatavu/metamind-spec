openapi: 3.0.7
info:
  title: Metamind API
  description: Brain spec for Metamind.
  version: 2.0.0
security:
  - basicAuth:
      []
paths:
  /stories:
    get:
      operationId: listStories
      summary: List stories
      description: List stories
      tags:
        - Stories
      responses:
        "200":
          description: Stories
          content:
            application/json;charset=utf-8:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/Story"
        "400":
          description: Invalid request was sent to the server
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "403":
          description: Attempted to make a call with unauthorized client
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "500":
          description: Internal server error
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
    post:
      operationId: createStory
      summary: Create a story
      description: Create story
      tags:
        - Stories
      requestBody:
        content:
          application/json;charset=utf-8:
            schema:
              $ref: "#/components/schemas/Story"
        description: Payload
        required: true
      responses:
        "200":
          description: Created story
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/Story"
        "400":
          description: Invalid request was sent to the server
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "403":
          description: Attempted to make a call with unauthorized client
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "500":
          description: Internal server error
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
  /stories/{storyId}:
    get:
      operationId: findStory
      summary: Finds a story
      description: Finds a story
      tags:
        - Stories
      parameters:
        - name: storyId
          required: true
          in: path
          description: story id
          schema:
            type: string
            format: uuid
      responses:
        "200":
          description: Found story
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/Story"
        "400":
          description: Invalid request was sent to the server
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "403":
          description: Attempted to make a call with unauthorized client
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "500":
          description: Internal server error
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
    put:
      operationId: updateStory
      summary: Updates story
      description: Updates a story
      tags:
        - Stories
      parameters:
        - name: storyId
          required: true
          in: path
          description: story id
          schema:
            type: string
            format: uuid
      requestBody:
        content:
          application/json;charset=utf-8:
            schema:
              $ref: "#/components/schemas/Story"
        description: Payload
        required: true
      responses:
        "200":
          description: Updated story
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/Story"
        "400":
          description: Invalid request was sent to the server
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "403":
          description: Attempted to make a call with unauthorized client
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "500":
          description: Internal server error
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
    delete:
      operationId: deleteStory
      summary: Delete story
      description: Delete a story
      tags:
        - Stories
      parameters:
        - name: storyId
          required: true
          in: path
          description: story id
          schema:
            type: string
            format: uuid
      responses:
        "204":
          description: Successful removal
        "400":
          description: Invalid request was sent to the server
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "403":
          description: Attempted to make a call with unauthorized client
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "500":
          description: Internal server error
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
                
  /stories/{storyId}/knots:
    get:
      operationId: listKnots
      summary: List story knots
      description: List story knots
      parameters:
        - name: storyId
          required: true
          in: path
          description: story id
          schema:
            type: string
            format: uuid
      tags:
        - Knots
      responses:
        "200":
          description: Story knots
          content:
            application/json;charset=utf-8:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/Knot"
        "400":
          description: Invalid request was sent to the server
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "403":
          description: Attempted to make a call with unauthorized client
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "500":
          description: Internal server error
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
    post:
      operationId: createKnot
      summary: Create a story knot
      description: Create story knot
      tags:
        - Knots
      parameters:
        - name: storyId
          required: true
          in: path
          description: story id
          schema:
            type: string
            format: uuid
      requestBody:
        content:
          application/json;charset=utf-8:
            schema:
              $ref: "#/components/schemas/Knot"
        description: Payload
        required: true
      responses:
        "200":
          description: Created story knot
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/Knot"
        "400":
          description: Invalid request was sent to the server
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "403":
          description: Attempted to make a call with unauthorized client
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "500":
          description: Internal server error
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
  /stories/{storyId}/knots/{knotId}:
    get:
      operationId: findKnot
      summary: Finds a story knot
      description: Finds a story knot
      tags:
        - Knots
      parameters:
        - name: storyId
          required: true
          in: path
          description: story id
          schema:
            type: string
            format: uuid
        - name: knotId
          required: true
          in: path
          description: knot id
          schema:
            type: string
            format: uuid
      responses:
        "200":
          description: Found story knot
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/Knot"
        "400":
          description: Invalid request was sent to the server
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "403":
          description: Attempted to make a call with unauthorized client
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "500":
          description: Internal server error
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
    put:
      operationId: updateKnot
      summary: Updates knot
      description: Updates a knot
      tags:
        - Knots
      parameters:
        - name: storyId
          required: true
          in: path
          description: story id
          schema:
            type: string
            format: uuid
        - name: knotId
          required: true
          in: path
          description: knot id
          schema:
            type: string
            format: uuid
      requestBody:
        content:
          application/json;charset=utf-8:
            schema:
              $ref: "#/components/schemas/Knot"
        description: Payload
        required: true
      responses:
        "200":
          description: Updated story knot
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/Knot"
        "400":
          description: Invalid request was sent to the server
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "403":
          description: Attempted to make a call with unauthorized client
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "500":
          description: Internal server error
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
    delete:
      operationId: deleteKnot
      summary: Delete knot
      description: Delete a knot
      tags:
        - Knots
      parameters:
        - name: storyId
          required: true
          in: path
          description: story id
          schema:
            type: string
            format: uuid
        - name: knotId
          required: true
          in: path
          description: knot id
          schema:
            type: string
            format: uuid
      responses:
        "204":
          description: Successful removal
        "400":
          description: Invalid request was sent to the server
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "403":
          description: Attempted to make a call with unauthorized client
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "500":
          description: Internal server error
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/ErrorResponse"

  /stories/{storyId}/intents:
    get:
      operationId: listIntents
      summary: List story intents
      description: List story intents
      parameters:
        - name: storyId
          required: true
          in: path
          description: story id
          schema:
            type: string
            format: uuid
      tags:
        - Intents
      responses:
        "200":
          description: Story intents
          content:
            application/json;charset=utf-8:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/Intent"
        "400":
          description: Invalid request was sent to the server
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "403":
          description: Attempted to make a call with unauthorized client
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "500":
          description: Internal server error
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
    post:
      operationId: createIntent
      summary: Create a story intent
      description: Create story intent
      tags:
        - Intents
      parameters:
        - name: storyId
          required: true
          in: path
          description: story id
          schema:
            type: string
            format: uuid
      requestBody:
        content:
          application/json;charset=utf-8:
            schema:
              $ref: "#/components/schemas/Intent"
        description: Payload
        required: true
      responses:
        "200":
          description: Created story intent
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/Intent"
        "400":
          description: Invalid request was sent to the server
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "403":
          description: Attempted to make a call with unauthorized client
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "500":
          description: Internal server error
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
  /stories/{storyId}/intents/{intentId}:
    get:
      operationId: findIntent
      summary: Finds a story intent
      description: Finds a story intent
      tags:
        - Intents
      parameters:
        - name: storyId
          required: true
          in: path
          description: story id
          schema:
            type: string
            format: uuid
        - name: intentId
          required: true
          in: path
          description: intent id
          schema:
            type: string
            format: uuid
      responses:
        "200":
          description: Found story intent
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/Intent"
        "400":
          description: Invalid request was sent to the server
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "403":
          description: Attempted to make a call with unauthorized client
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "500":
          description: Internal server error
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
    put:
      operationId: updateIntent
      summary: Updates intent
      description: Updates a intent
      tags:
        - Intents
      parameters:
        - name: storyId
          required: true
          in: path
          description: story id
          schema:
            type: string
            format: uuid
        - name: intentId
          required: true
          in: path
          description: intent id
          schema:
            type: string
            format: uuid
      requestBody:
        content:
          application/json;charset=utf-8:
            schema:
              $ref: "#/components/schemas/Intent"
        description: Payload
        required: true
      responses:
        "200":
          description: Updated story intent
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/Intent"
        "400":
          description: Invalid request was sent to the server
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "403":
          description: Attempted to make a call with unauthorized client
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "500":
          description: Internal server error
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
    delete:
      operationId: deleteIntent
      summary: Delete intent
      description: Delete a intent
      tags:
        - Intents
      parameters:
        - name: storyId
          required: true
          in: path
          description: story id
          schema:
            type: string
            format: uuid
        - name: intentId
          required: true
          in: path
          description: intent id
          schema:
            type: string
            format: uuid
      responses:
        "204":
          description: Successful removal
        "400":
          description: Invalid request was sent to the server
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "403":
          description: Attempted to make a call with unauthorized client
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "500":
          description: Internal server error
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/ErrorResponse"

  /stories/{storyId}/sessions:
    post:
      operationId: createSession
      summary: Creates new session
      description: Creates new chat session
      requestBody:
        content:
          application/json;charset=utf-8:
            schema:
              $ref: "#/components/schemas/Session"
        description: Payload
        required: true
      tags:
        - Sessions
      parameters:
        - name: storyId
          required: true
          in: path
          description: story id
          schema:
            type: string
            format: uuid
      responses:
        "200":
          description: Created session
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/Session"
        "400":
          description: Invalid request was sent to the server
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "403":
          description: Attempted to make a call with unauthorized client
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "500":
          description: Internal server error
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
                
                
  /stories/{storyId}/messages:
    post:
      operationId: createMessage
      summary: Posts new message
      description: Posts new message
      requestBody:
        content:
          application/json;charset=utf-8:
            schema:
              $ref: "#/components/schemas/Message"
        description: Payload
        required: true
      parameters:
        - name: storyId
          required: true
          in: path
          description: story id
          schema:
            type: string
            format: uuid
      tags:
        - Messages
      responses:
        "200":
          description: Returns message with bot's response details
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/Message"
        "400":
          description: Invalid request was sent to the server
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "403":
          description: Attempted to make a call with unauthorized client
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "500":
          description: Internal server error
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/ErrorResponse"

  /scripts:
    get:
      operationId: listScripts
      summary: List scripts
      description: List scripts
      tags:
        - Scripts
      responses:
        "200":
          description: Scripts
          content:
            application/json;charset=utf-8:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/Script"
        "400":
          description: Invalid request was sent to the server
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "403":
          description: Attempted to make a call with unauthorized client
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "500":
          description: Internal server error
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
    post:
      operationId: createScript
      summary: Create a script
      description: Create script
      tags:
        - Scripts
      requestBody:
        content:
          application/json;charset=utf-8:
            schema:
              $ref: "#/components/schemas/Script"
        description: Payload
        required: true
      responses:
        "200":
          description: Created script
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/Script"
        "400":
          description: Invalid request was sent to the server
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "403":
          description: Attempted to make a call with unauthorized client
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "500":
          description: Internal server error
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
  /scripts/{scriptId}:
    get:
      operationId: findScript
      summary: Finds a script
      description: Finds a script
      tags:
        - Scripts
      parameters:
        - name: scriptId
          required: true
          in: path
          description: script id
          schema:
            type: string
            format: uuid
      responses:
        "200":
          description: Found script
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/Script"
        "400":
          description: Invalid request was sent to the server
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "403":
          description: Attempted to make a call with unauthorized client
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "500":
          description: Internal server error
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
    put:
      operationId: updateScript
      summary: Updates script
      description: Updates a script
      tags:
        - Scripts
      parameters:
        - name: scriptId
          required: true
          in: path
          description: script id
          schema:
            type: string
            format: uuid
      requestBody:
        content:
          application/json;charset=utf-8:
            schema:
              $ref: "#/components/schemas/Script"
        description: Payload
        required: true
      responses:
        "200":
          description: Updated script
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/Script"
        "400":
          description: Invalid request was sent to the server
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "403":
          description: Attempted to make a call with unauthorized client
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "500":
          description: Internal server error
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
    delete:
      operationId: deleteScript
      summary: Delete script
      description: Delete a script
      tags:
        - Scripts
      parameters:
        - name: scriptId
          required: true
          in: path
          description: script id
          schema:
            type: string
            format: uuid
      responses:
        "204":
          description: Successful removal
        "400":
          description: Invalid request was sent to the server
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "403":
          description: Attempted to make a call with unauthorized client
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "500":
          description: Internal server error
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/ErrorResponse"

  /trainingMaterials:
    get:
      operationId: listTrainingMaterials
      summary: List trainingMaterials
      description: List training materials
      tags:
        - TrainingMaterials
      parameters:
        - name: storyId
          required: false
          in: query
          description: story id
          schema:
            type: string
            format: uuid
        - name: type
          required: false
          in: query
          description: training material type
          schema:
            $ref: "#/components/schemas/TrainingMaterialType"
      responses:
        "200":
          description: TrainingMaterials
          content:
            application/json;charset=utf-8:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/TrainingMaterial"
        "400":
          description: Invalid request was sent to the server
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "403":
          description: Attempted to make a call with unauthorized client
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "500":
          description: Internal server error
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
    post:
      operationId: createTrainingMaterial
      summary: Create a trainingMaterial
      description: Create training material
      tags:
        - TrainingMaterials
      requestBody:
        content:
          application/json;charset=utf-8:
            schema:
              $ref: "#/components/schemas/TrainingMaterial"
        description: Payload
        required: true
      responses:
        "200":
          description: Created trainingMaterial
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/TrainingMaterial"
        "400":
          description: Invalid request was sent to the server
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "403":
          description: Attempted to make a call with unauthorized client
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "500":
          description: Internal server error
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
  /trainingMaterials/{trainingMaterialId}:
    get:
      operationId: findTrainingMaterial
      summary: Finds a trainingMaterial
      description: Finds a training material
      tags:
        - TrainingMaterials
      parameters:
        - name: trainingMaterialId
          required: true
          in: path
          description: trainingMaterial id
          schema:
            type: string
            format: uuid
      responses:
        "200":
          description: Found trainingMaterial
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/TrainingMaterial"
        "400":
          description: Invalid request was sent to the server
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "403":
          description: Attempted to make a call with unauthorized client
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "500":
          description: Internal server error
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
    put:
      operationId: updateTrainingMaterial
      summary: Updates trainingMaterial
      description: Updates a training material
      tags:
        - TrainingMaterials
      parameters:
        - name: trainingMaterialId
          required: true
          in: path
          description: trainingMaterial id
          schema:
            type: string
            format: uuid
      requestBody:
        content:
          application/json;charset=utf-8:
            schema:
              $ref: "#/components/schemas/TrainingMaterial"
        description: Payload
        required: true
      responses:
        "200":
          description: Updated trainingMaterial
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/TrainingMaterial"
        "400":
          description: Invalid request was sent to the server
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "403":
          description: Attempted to make a call with unauthorized client
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "500":
          description: Internal server error
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
    delete:
      operationId: deleteTrainingMaterial
      summary: Delete trainingMaterial
      description: Delete a training material
      tags:
        - TrainingMaterials
      parameters:
        - name: trainingMaterialId
          required: true
          in: path
          description: trainingMaterial id
          schema:
            type: string
            format: uuid
      responses:
        "204":
          description: Successful removal
        "400":
          description: Invalid request was sent to the server
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "403":
          description: Attempted to make a call with unauthorized client
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "500":
          description: Internal server error
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/ErrorResponse"

  /stories/{storyId}/variables:
    get:
      operationId: listVariables
      summary: List story variables
      description: List story variables
      parameters:
        - name: storyId
          required: true
          in: path
          description: story id
          schema:
            type: string
            format: uuid
      tags:
        - Variables
      responses:
        "200":
          description: Story variables
          content:
            application/json;charset=utf-8:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/Variable"
        "400":
          description: Invalid request was sent to the server
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "403":
          description: Attempted to make a call with unauthorized client
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "500":
          description: Internal server error
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
    post:
      operationId: createVariable
      summary: Create a story variable
      description: Create story variable
      tags:
        - Variables
      parameters:
        - name: storyId
          required: true
          in: path
          description: story id
          schema:
            type: string
            format: uuid
      requestBody:
        content:
          application/json;charset=utf-8:
            schema:
              $ref: "#/components/schemas/Variable"
        description: Payload
        required: true
      responses:
        "200":
          description: Created story variable
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/Variable"
        "400":
          description: Invalid request was sent to the server
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "403":
          description: Attempted to make a call with unauthorized client
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "500":
          description: Internal server error
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
  /stories/{storyId}/variables/{variableId}:
    get:
      operationId: findVariable
      summary: Finds a story variable
      description: Finds a story variable
      tags:
        - Variables
      parameters:
        - name: storyId
          required: true
          in: path
          description: story id
          schema:
            type: string
            format: uuid
        - name: variableId
          required: true
          in: path
          description: variable id
          schema:
            type: string
            format: uuid
      responses:
        "200":
          description: Found story variable
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/Variable"
        "400":
          description: Invalid request was sent to the server
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "403":
          description: Attempted to make a call with unauthorized client
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "500":
          description: Internal server error
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
    put:
      operationId: updateVariable
      summary: Updates variable
      description: Updates a variable
      tags:
        - Variables
      parameters:
        - name: storyId
          required: true
          in: path
          description: story id
          schema:
            type: string
            format: uuid
        - name: variableId
          required: true
          in: path
          description: variable id
          schema:
            type: string
            format: uuid
      requestBody:
        content:
          application/json;charset=utf-8:
            schema:
              $ref: "#/components/schemas/Variable"
        description: Payload
        required: true
      responses:
        "200":
          description: Updated story variable
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/Story"
        "400":
          description: Invalid request was sent to the server
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "403":
          description: Attempted to make a call with unauthorized client
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "500":
          description: Internal server error
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
    delete:
      operationId: deleteVariable
      summary: Delete variable
      description: Delete a variable
      tags:
        - Variables
      parameters:
        - name: storyId
          required: true
          in: path
          description: story id
          schema:
            type: string
            format: uuid
        - name: variableId
          required: true
          in: path
          description: variable id
          schema:
            type: string
            format: uuid
      responses:
        "204":
          description: Successful removal
        "400":
          description: Invalid request was sent to the server
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "403":
          description: Attempted to make a call with unauthorized client
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "500":
          description: Internal server error
          content:
            application/json;charset=utf-8:
              schema:
                $ref: "#/components/schemas/ErrorResponse"

servers:
  - url: /v2
components:
  securitySchemes:
    basicAuth:
      type: http
      scheme: basic
  schemas:

    Story:
      type: object
      required:
        - name
        - locale
      properties:
        id:
          description: Story id.
          type: string
          format: uuid
          readOnly: true
        name:
          description: Story name.
          type: string
        locale:
          description: Story locale.
          type: string
        quickResponses:
          description: List of story global quick responses.
          type: array
          items:
            type: string
          readOnly: true
        createdAt:
          description: Creation time
          type: string
          format: date-time
          readOnly: true
        modifiedAt:
          description: Last modification time
          type: string
          format: date-time
          readOnly: true
  
    Session:
      type: object
      required:
        - type
        - locale
        - timeZone
        - visitor
      properties:
        id:
          description: Session id.
          type: string
          format: uuid
          readOnly: true
        locale:
          description: Session locale
          type: string
        timeZone:
          description: Session time zone
          type: string
        visitor:
          description: Visitor details
          type: string
        storyId:
          description: Story id
          type: string
          format: uuid
          readOnly: true
        createdAt:
          description: Creation time
          type: string
          format: date-time
          readOnly: true
        modifiedAt:
          description: Last modification time
          type: string
          format: date-time
          readOnly: true
          
    Knot:
      type: object
      required:
        - type
        - name
        - content
        - tokenizer
      properties:
        id:
          description: knot id.
          type: string
          format: uuid
          readOnly: true
        type: 
          $ref: "#/components/schemas/KnotType"
        tokenizer:
          $ref: "#/components/schemas/TokenizerType"          
        name:
          type: string
        content:
          type: string
        hint:
          type: string
        storyId:
          description: Story id
          type: string
          format: uuid
          readOnly: true
        createdAt:
          description: Creation time
          type: string
          format: date-time
          readOnly: true
        modifiedAt:
          description: Last modification time
          type: string
          format: date-time
          readOnly: true
        
    KnotType:
      type: string
      enum:
        - TEXT
        - SCRIPT
        - IMAGE
        - EMAIL
          
    Intent:
      type: object
      required:
        - type
        - targetKnotId
        - global
        - trainingMaterials
        - quickResponseOrder
      properties:
        id:
          description: intent id.
          type: string
          format: uuid
          readOnly: true
        name:
          type: string
        quickResponse:
          type: string
        quickResponseOrder:
          type: integer
          format: int32
        type: 
          $ref: "#/components/schemas/IntentType"
        sourceKnotId:
          description: source knot id id.
          type: string
          format: uuid
        targetKnotId:
          description: target knot id id.
          type: string
          format: uuid
        global:
          type: boolean
        trainingMaterials:
          type: object
          properties:
            intentOpenNlpDoccatId:
              description: Intent OpenNLP Doccat training material id
              type: string
              format: uuid
            intentRegexId:
              description: Intent regex training material id
              type: string
              format: uuid
            variableOpenNlpNerId:
              description: Variable OpenNLP NER training material id
              type: string
              format: uuid
            variableOpenNlpRegex:
              description: Variable OpenNLP Regex training material id
              type: string
              format: uuid
        createdAt:
          description: Creation time
          type: string
          format: date-time
          readOnly: true
        modifiedAt:
          description: Last modification time
          type: string
          format: date-time
          readOnly: true
        
    IntentType:
      type: string
      enum:
        - NORMAL
        - CONFUSED
        - REDIRECT
        - DEFAULT

    TokenizerType:
      type: string
      enum:
        - WHITESPACE
        - UNTOKENIZED

    TrainingMaterial:
      required:
        - name
        - text
      properties:
        id:
          description: intent id.
          type: string
          format: uuid
          readOnly: true
        type: 
          $ref: "#/components/schemas/TrainingMaterialType"
        storyId:
          type: string
          format: uuid
        text:
          type: string
        name:
          type: string
        createdAt:
          description: Creation time
          type: string
          format: date-time
          readOnly: true
        modifiedAt:
          description: Last modification time
          type: string
          format: date-time
          readOnly: true
          
    TrainingMaterialType:
      type: string
      enum:
        - INTENTREGEX
        - INTENTOPENNLPDOCCAT
        - VARIABLEOPENNLPNER
        - VARIABLEOPENNLPREGEX

    Message:
      type: object
      required:
        - sessionId
        - content
      properties:
        id:
          description: Message id
          type: string
          format: uuid
          readOnly: true
        sessionId:
          description: Session id the message belongs to
          type: string
          format: uuid
        content:
          description: Message content
          type: string
        response:
          description: Response text. Used only when responding
          type: 
            array
          items:
            type: string
          readOnly: true
        hint:
          description: Hint text. Used only when responding
          type: string
          readOnly: true
        quickResponses:
          description: List of quick responses. Used only when responding
          type: array
          items:
            type: string
          readOnly: true
        confidence:
          description: Value how confident the bot was about the intent
          type: number
          format: double
          readOnly: true
        sourceKnotId:
          description: source knot id id.
          type: string
          format: uuid
          readOnly: true
        matchedIntentId:
          description: matched intent id. Null if intent not found
          type: string
          format: uuid
          readOnly: true
        createdAt:
          description: Creation time
          type: string
          format: date-time
          readOnly: true
        modifiedAt:
          description: Last modification time
          type: string
          format: date-time
          readOnly: true

    Variable:
      type: object
      required:
        - name
        - type
      properties:
        id:
          description: variable id.
          type: string
          format: uuid
          readOnly: true
        name: 
          type: string
        type: 
          $ref: "#/components/schemas/VariableType"
        storyId:
          description: Story id
          type: string
          format: uuid
          readOnly: true
        validationScript:
          type: string
          description: Validation script
        createdAt:
          description: Creation time
          type: string
          format: date-time
          readOnly: true
        modifiedAt:
          description: Last modification time
          type: string
          format: date-time
          readOnly: true

    VariableType:
      type: string
      enum:
        - STRING
        - NUMBER
          
    Script:
      type: object
      required:
        - name
        - version
        - language
        - content
      properties:
        id:
          description: Script id
          type: string
          format: uuid
          readOnly: true
        name:
          description: Script name
          type: string
        version:
          description: Script version
          type: string
        language:
          description: Script language
          type: string
        content:
          description: Script content
          type: string
        createdAt:
          description: Creation time
          type: string
          format: date-time
          readOnly: true
        modifiedAt:
          description: Last modification time
          type: string
          format: date-time
          readOnly: true

    ErrorResponse:
      type: object
      properties:
        message:
          description: The error message
          type: string
          readOnly: true